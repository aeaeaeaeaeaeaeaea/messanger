<!DOCTYPE html>
<html>

<head>
	<meta charset="UTF-8">
	<title>Insert title here</title>
</head>

<body>



	<form id="chatForm">
		<input type="text" id="messageInput" th:data="${id}" placeholder="Type a message...">
		<button type="submit">Send</button>
	</form>


	<!-- Ваш HTML-код -->

	<!-- Ваш HTML-код -->

	<script src="/webjars/sockjs-client/1.1.4/sockjs.min.js"></script>
	<script src="/webjars/stomp-websocket/2.3.4/stomp.min.js"></script>

	<script>
		var stompClient = null;

		function connect() {
			var socket = new SockJS('/chat');
			stompClient = Stomp.over(socket);
			stompClient.connect({}, function (frame) {
				console.log('Connected: ' + frame);

				stompClient.subscribe('/topic/public', function (message) {
					showMessage(JSON.parse(message.body));
				});
			});
		}

		function showMessage(message) {
			var messageDiv = document.createElement('div');
			messageDiv.textContent = message.sender + ': ' + message.content;
			document.getElementById('chatMessages').appendChild(messageDiv);
		}

		function sendMessage() {
			var messageInput = document.getElementById('messageInput');
			var messageContent = messageInput.value;
			var sender = messageInput.getAttribute("data");
			console.log("Sender:", sender); // Отладочный вывод значения sender
			var message = {
				sender: sender,
				content: messageContent
			};
			stompClient.send('/app/chat.sendMessage', {}, JSON.stringify(message));
			messageInput.value = '';
		}


		document.getElementById('chatForm').addEventListener('submit', function (event) {
			event.preventDefault();
			sendMessage();
		});

		window.onload = function () {
			connect();
		};
	</script>



</body>

</html>